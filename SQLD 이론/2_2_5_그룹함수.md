# 그룹 함수

## ROLLUP
- 소그룹 별 소계 계산 추가(순서 중요)
  - 각 DNAME/JOB별 집계
  - 각 DNAME별 집계
  - 전체 집계
```sql
SELECT DNAME, JOB, COUNT(*) 직원수, SUM(SAL) AS 급여합
FROM EMP, DEPT
WHERE DEPT.DEPTNO = EMP.DEPTNO
GROUP BY ROLLUP(DNAME, JOB)
ORDER BY DNAME, JOB;
```
- GROUPING 함수의 사용
  - 어디까지 집계되었는지 알려주는 용도로 사용됨
```sql
SELECT DNAME, GROUPING(DNAME), JOB, GROUPING(JOB), COUNT(*) 직원수, SUM(SAL) AS 급여합
FROM EMP, DEPT
WHERE DEPT.DEPTNO = EMP.DEPTNO
GROUP BY ROLLUP(DNAME, JOB)
```

- GROUPING + CASE의 사용
```sql
SELECT
  CASE GROUPING(DNAME)
    WHEN 1 THEN 'ALL Departments'
    ELSE DNAME
  END AS DNAME,

  CASE GROUPING(JOB)
    WHEN 1 THEN 'All Jobs'
    ELSE JOB
  END AS JOB,

  COUNT(*) "Total Emp", SUM(SAL) "Total Sal
  "
FROM EMP, DEPT
WHERE DEPT.DEPTNO = EMP.DEPTON
GROUP BY ROLLUP (DNAME, JOB);
```

## CUBE
- 다차원 소계 계산 추가 (순서 무관)
- 모든 조합의 집계 계산 -> 시스템 부하가 큼
```sql
SELECT DNAME, JOB, COUNT(*) 직원수, SUM(SAL) AS 급여합
FROM EMP, DEPT
WHERE DEPT.DEPTNO = EMP.DEPTNO
GROUP BY CUBE(DNAME, JOB)
ORDER BY DNAME, JOB;
```

## GROUPING SETS
- 여러 칼럼 `각각`에 대해 `반복적`으로 그룹화
```sql
SELECT DNAME, JOB, COUNT(*) 직원수, SUM(SAL) 급여합
FROM EMP, DEPT
WHERE DEPT.DEPTNO = EMP.DEPTNO
GROUP BY GROUPING SETS (DNAME, JOB)
```